# CREATING A POD

***

PRE KRIRNJA POD-A DA TI KAZM DA TVOJ CLUSTER MORA BITI STARTED, A TO SA `minipod` PROSTO RADIS OVAKO

- `minipod start`

MOZES DA URADI I OVO

- `eval $(minikube docker-env)` (NISAM SIGURAN ALI MISLIM DA OVO TREBA ZA SVAKI OTVOREN NOVI TERMINAL) (**ALI MISLIM DA OVO NISTA NE RADDI**)

***

SADA CU KREIATI CONFIG FILE, SA KOJIM CU KRIRATI POD DIREKTNO

OD MOG POST SERVICE-A, STO ZNACI DA CU PRVO NAPRAVITI IMAGE ZA POSTS

- `cd posts`

- `docker build -t radebajic/posts:0.0.1 .`
  
- `docker images`

```c
REPOSITORY                    TAG              IMAGE ID       CREATED        SIZE
radebajic/posts               0.0.1            8d6f9ce5d76b   1 minute ago   125MB
node                          lts-alpine3.12   8f86419010df   7 days ago     117MB
gcr.io/k8s-minikube/kicbase   v0.0.18          a776c544501a   3 weeks ago    1.08GB
```

# SADA CU DA NAPISEM JEDAN CONFIGURATION FILE, SA KOJIM CU DEFINISATI KREIRANJE POD, KORISCENJEM GORNJEG DOCKER IMAGE-A

KREIRACU NOVE DIREKTORIJUME U ROOT-U

- `mkdir infra` (ZNACI INFRASTRUCTURE)

- `mkdir/infra/k8s` (ZNACI KUBERNETES (IMA 8 SLAOVA IZMEDJU k I s))

KRIRAM FILE, KOJI SE DAKLE ODNOSI NA posts SERVICE, ODNONO KORISTICU OVAJ FILE DA SE NAPRAVI POD ZA RUNNING posts SERVICE-A

- `touch infra/k8s/posts.yaml`

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: posts
spec:
  containers:
    - name: posts
      image: radebajic/posts:0.0.1
```

KADA OVO RUNN-UJEM, RECI CU KUBERNETES CLUSTERU, DA JA ZELIM DA NAPRAVIM POD

DA PODOVO IME BUDE `posts`

**I DA ZELIM DA KRIRAM EXACTLY ONE CONTAINER, ISTATICIZIRAN OD SPECIFIED IMAGE-A**

# ONO STO U SLUCAJU `minicube`-A NE SMEM DA ZABORAVIM JESTE DA IMAGE DODAM U MIMICUBE REGISTRY

TO SAM TI VEC JEDNOM REKAO (A JEDVA SAM SAZNAO ZA OVO)

- `minicube cache add radebajic/posts:0.0.1`

# SADA MOZES DA POKRENES PRAVLJENJE NOVOG OBJEKTA,, ODNOSNO POD-A

- `cd infra/k8s`

- `ls`

```bash
posts.yaml
```

KUCAS KOMANDU (KOJA KORISTI ONAJ `kubectl`)

- `kubectl apply -f posts.yaml`

BICE INDICATED DA JE POSTS CREATED

KUCAM SLEDECU KOMADU DA PROVERIM DA LI JE ZAISTA CREATED, ILI JOS VAZNIJE DA LI JE U RUNNING STATE-U

- `kubectl get pods`

```c
NAME    READY   STATUS    RESTARTS   AGE
posts   1/1     Running   0          1m

```

DAKLE POD JE KREIRAN I ON RUNN-UJE

# UNDERSTANDING A POD SPEC

DAKLE ZELI MDA OBJASNIM, yaml FAJL, LINE BY LINE

- `cat infra/k8s/posts.yaml`

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: posts
spec:
  containers:
    - name: posts
      image: radebajic/posts:0.0.1

```

`apiVersion` SPECIFICIRA SET OF OBJECTS, KOJE ZELIMO DA KUBERNATES POGLEDA, ODNOSNO POOL OF OBJECTS, IZ KOJEG ZELLIMO DA DRAW-UJEMO (OVO JE DEFAULT v1 KUBERNETES LIAT OF OBJECTS KKOJE MOZEMO KREIRATI)

RANIJE SAM RKAO DA SU **OBJECTS: DEPLOYMENTS, SERVICES I PODS**

`kind: Pod` JASNO JE DA ZELIM DA KREIRAM POD (TAJ TYPE OF OBJECT) (ON WRAPP-UJE CONTAINER)

SADAJE SPECIFICIRNA METDATA

TU JE IME POD-A (DA PROMENIM IME I PONOVO RUNN-UJEM OBJECT CREATION, BILO BI TO IME A NE OVO SADASNJE)

A DALJE JE `spec`; A TO JE LIST OF CONFIGURATION OPTIONS ZA OBJECT (U OVOM SLUCAJU POD KOJI ZELIM DA KREIRAM)

**`containers` JE ARRAY OF ENTITIES, A JA SAMO IMAM JEDAN UNOS U TAJ ARRAY, A TO ZNACI DA PRAVIM SAMO JEDAN CONTAINER**

OTUDA ONA CRTICA U NASTAVKU, JER DA IMA SLEDECI UNOS, ON BI IMAO CRTICU ISPRED (IZGLEDA DA TO ODREDJUJE DA SE RADI O ITEMU containers LISTE)

**ONO STO SE KREIRA JE CONTAINER, KOJI CE BITI WRAPPED U POD-U I KOJI CE IMATI TAG `posts` JER TO SAM STAVIO UNDER name OPTION**

**I NAVEO SAM NAME IMAGE-A (ODNOSNO TAG), OD KOJEG CE SE INSTATICIZIRATI CONTAINER**

MORAO SAM STAVITI VERZIJU

AKO SE SECAS, KADA NE STAVIS VERZIJU, DOCKER PRAVI CONTAINER SA `latest` VERSIONOM

DA SI TI STAVIO SAMO radebajic/posts ONDA BI KUBERNETES REACH-OVAO DO DOCKER HUB-A

ALI JA NISAM PUSH-OVAO IMAGE TO DOCKER HUB, I IMAO BI ERROR DA SAM IZOSTAVIO POMENUTI VERSION, KADA BI RUNN-OVAO PRAVLJENJE POD-A

ISTO TAKO, OVDE U MOM SLUCAJU, SA OVAKVIM SETTING-OM **IMAGE CE SE UZETI IZ MINNIKUBE REGISTRA, ILI CACHE-A, SAMO ATO STO SAM GA JA TAMO TAVIO** (NA WINDOWS-U I MAC-U NIJE TAKO, JER TAMO CLUSTER REACH-UJE ZA DOCKER CACHE-OM ODMAH, A NE ZA KUBERNETES REGISTROM) (MEDJUTIM JA SAM URADIO PRAVU STVAR JER SAM IMAGE UBACIO U POMENUTI REGISTAR)

***
***

AKO DOBRO POGLEDAS SHVATAS DA SAM DEFINISAO DA I POD, A I CONTAINER IMAJU ISTO IME

TO SI OVDE URADIO, JER IMAS SAMO JEDAN CONTAINER

SIGURNO DA KREIRAS VISE CONTAINER-A, TO NE BI TAKO RADIO

***
***


**NAMA IME PODA I CONTAINERA ZNACI U SLUCAJU DEBUGGING-A, DA ZNAMO U STA GLEAMO**
